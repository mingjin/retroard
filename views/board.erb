<!DOCTYPE html>
<html>
<head>
    <title>Team Retrospective</title>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8"/>
    <meta name="keywords" content="agile,retro,retrospective,board,team,building,tool"/>
    <meta name="description"
          content="This is an online retrospective board, which enables distributed teams to organize retrospectives just like they are co-located."/>
    <link rel="stylesheet" type="text/css" href="css/global.css"/>
    <link rel="stylesheet" type="text/css" href="css/board.css"/>

    <script type="text/javascript" src="javascripts/libs/jquery-1.7.min.js"></script>
    <script type="text/javascript" src="javascripts/libs/jquery.json-2.3.min.js"></script>
    <script type="text/javascript" src="javascripts/utilities.js"></script>
    <script type="text/javascript" src="javascripts/webSocket.js"></script>
    <script type="text/javascript" src="javascripts/listener.js"></script>
    <script type="text/javascript" src="javascripts/sticky.js"></script>
    <script type="text/javascript" src="javascripts/dialog.js"></script>
    <script type="text/javascript" src="javascripts/section.js"></script>
    <script type="text/javascript" src="javascripts/history.js"></script>
    <script type="text/javascript" src="javascripts/board.js"></script>

    <script  type="text/javascript">
        window.teamName = "<%= params[:team] %>"
        $(document).ready(function() {
			var option = {'serverHost': '<%= request.host %>', 'serverPort': '<%= request.port %>'}
            var board = new Board(['well', 'lessWell', 'puzzle', 'idea']);
            board.initialize(option);
			$.getJSON('/'+ teamName + '/existing_cards', function(sections) {
				for (var sectionName in sections) {
					var currentSection = board.getSection(sectionName);
				    for(var uuid in sections[sectionName]) {
						var sticky = currentSection.addSticky(uuid);
						sticky.update({content:sections[sectionName][uuid].content});
					}
				}
			})
        })
    </script>

</head>
<body>
<div class="wrap">
<header>
    <div class="headerWrap clearFloat">
        <img id="logo" src="/images/logo.jpg"/>
        <h2>Team Retro</h2>
        <h3><a href="/<%=params[:team]%>/profile"><%=params[:team]%></a></h3>
        <span class="separator">|</span>
        <a href="#">Create</a>
        <a href="#">Export</a>
        <span class="separator">|</span>
        <a href="#">Group</a>
        <a href="#">Vote</a>
        <a href="#">Action</a>
        <a href="#">Complete</a>
        <span class="separator">|</span>
        <a href="#" id="historyHeaderButton">
            <span>
                History
            </span>
        </a>
        <div id="historyDialog">
            <ul>
                <li>
                    <a href="#">Sprint1</a>
                </li>
                <li>
                    <a href="#">Sprint2</a>
                </li>
                <li>
                    <a href="#">Sprint3</a>
                </li>
            </ul>
        </div>
    </div>
</header>
<article id="sections">
<% @sections.each do |section| %>
    <section class="section" id="<%= section[:id] %>">
        <div class="sectionHeader">
            <h3><%= section[:display] %></h3>

            <div class="addStickyButton"></div>
        </div>
        <div class="sectionBody">
        </div>
    </section>
<% end %>
<div id="stickyDialog">
    <textarea></textarea>
    <div class="buttons">
        <button type="image" value="OK" class="okButton">OK</button>
        <button type="image" value="Cancel" class="cancelButton">Cancel</button>
    </div>
</div>
</article>
<footer>
    &copy; 2011 Team-Cares
</footer>
</div>
<div id="modal"></div>
</body>
</html>
